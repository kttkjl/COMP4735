
#include "hal.h"

const char letters [95][13]  = {
{0x00, 0x00, 0x7f, 0xc3, 0xc3, 0x7f, 0x03, 0xc3, 0x7e, 0x00, 0x00, 0x00, 0x00}, // This is a
{0x00, 0x00, 0xfe, 0xc3, 0xc3, 0xc3, 0xc3, 0xfe, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0},
{0x00, 0x00, 0x7e, 0xc3, 0xc0, 0xc0, 0xc0, 0xc3, 0x7e, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0x7f, 0xc3, 0xc3, 0xc3, 0xc3, 0x7f, 0x03, 0x03, 0x03, 0x03, 0x03},
{0x00, 0x00, 0x7f, 0xc0, 0xc0, 0xfe, 0xc3, 0xc3, 0x7e, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0x30, 0x30, 0x30, 0x30, 0x30, 0xfc, 0x30, 0x30, 0x30, 0x33, 0x1e},
{0x7e, 0xc3, 0x03, 0x03, 0x7f, 0xc3, 0xc3, 0xc3, 0x7e, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xc3, 0xfe, 0xc0, 0xc0, 0xc0, 0xc0},
{0x00, 0x00, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x00, 0x00, 0x18, 0x00},
{0x38, 0x6c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x00, 0x00, 0x0c, 0x00},
{0x00, 0x00, 0xc6, 0xcc, 0xf8, 0xf0, 0xd8, 0xcc, 0xc6, 0xc0, 0xc0, 0xc0, 0xc0},
{0x00, 0x00, 0x7e, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x78},
{0x00, 0x00, 0xdb, 0xdb, 0xdb, 0xdb, 0xdb, 0xdb, 0xfe, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xfc, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0x7c, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x7c, 0x00, 0x00, 0x00, 0x00},
{0xc0, 0xc0, 0xc0, 0xfe, 0xc3, 0xc3, 0xc3, 0xc3, 0xfe, 0x00, 0x00, 0x00, 0x00},
{0x03, 0x03, 0x03, 0x7f, 0xc3, 0xc3, 0xc3, 0xc3, 0x7f, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xc0, 0xc0, 0xc0, 0xc0, 0xc0, 0xe0, 0xfe, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xfe, 0x03, 0x03, 0x7e, 0xc0, 0xc0, 0x7f, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0x1c, 0x36, 0x30, 0x30, 0x30, 0x30, 0xfc, 0x30, 0x30, 0x30, 0x00},
{0x00, 0x00, 0x7e, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0xc6, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0x18, 0x3c, 0x3c, 0x66, 0x66, 0xc3, 0xc3, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xc3, 0xe7, 0xff, 0xdb, 0xc3, 0xc3, 0xc3, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xc3, 0x66, 0x3c, 0x18, 0x3c, 0x66, 0xc3, 0x00, 0x00, 0x00, 0x00},
{0xc0, 0x60, 0x60, 0x30, 0x18, 0x3c, 0x66, 0x66, 0xc3, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0xff, 0x60, 0x30, 0x18, 0x0c, 0x06, 0xff, 0x00, 0x00, 0x00, 0x00},
{0x00, 0x00, 0x0f, 0x18, 0x18, 0x18, 0x38, 0xf0, 0x38, 0x18, 0x18, 0x18, 0x0f}, //this is z
};


void hal_io_serial_init(){
	uart_init();
}

void hal_io_serial_putc(uint32_t serial_id, uint8_t ch) {
  // assume 0 for serial_id for now
  uart_putc(ch);
}

void hal_io_serial_puts(uint32_t serial_id, uint8_t * ch) {
  // assume 0 for serial_id for now
  uart_puts((uint8_t *)ch);
}

uint8_t hal_io_serial_getc(uint32_t serial_id) {
  return uart_getc();
}

void hal_io_video_init() {
  _video_init();
}

void hal_io_video_putpixel(int x_pos, int y_pos, uint32_t color){
  int y = y_pos * 1280;
  _vc_draw_pixel(x_pos, y, color);
}

void hal_io_video_putc(int x_pos, int y_pos, uint32_t color, char ch){
  int bits[8];
  char hex_value;
  int x = x_pos;
  int y = y_pos;

  char a[32][2] = {{0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x1f, 0x80},  //...%%%%%%.. 
  {0x30, 0xc0},  //..%%....%%. 
  {0x00, 0x40},  //.........%. 
  {0x00, 0x60},  //.........%% 
  {0x00, 0x20},  //..........% 
  {0x00, 0x20},  //..........% 
  {0x0f, 0xe0},  //....%%%%%%% 
  {0x30, 0x60},  //..%%.....%% 
  {0x40, 0x20},  //.%........% 
  {0xc0, 0x60},  //%%.......%% 
  {0xc0, 0x60},  //%%.......%% 
  {0xc0, 0xe0},  //%%......%%% 
  {0x61, 0xa0},  //.%%....%%.% 
  {0x3e, 0x20},  //..%%%%%...% 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00},  //........... 
  {0x00, 0x00}};  //........... 

  for (int i = 0; i < 13; ++i) {
    // Per row
    // hex_value = letters[ch-97][i];

    hex_to_binary(bits, hex_value);
   
    for (int j = 0; j < 8; ++j) {
      if (bits[j]) {
        hal_io_video_putpixel(x+j, y+i, 0xFFFFFFFF);
      }
    }
  }

}

void hex_to_binary(int *bits, unsigned int hex) {
  for (int i = 0; i < 8; ++i) {
    bits[i] = (hex >> i) & 1;
  }
}
